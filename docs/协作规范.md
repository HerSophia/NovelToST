# 协作规范（v2）

## 1. 分支策略

- `main`：受保护分支，仅通过 PR 合并。
- 功能分支命名建议：
  - `feature/novel-to-st-xxx`
  - `fix/novel-to-st-xxx`
  - `chore/xxx`
  - `docs/xxx`

## 2. Commit 规范

建议采用 Conventional Commits：

- `feat:` 新功能
- `fix:` 缺陷修复
- `refactor:` 重构（不改行为）
- `docs:` 文档
- `chore:` 构建/依赖/流程
- `ci:` 工作流

示例：

- `feat: add novelToST generation store`
- `ci: add test and build workflows`
- `docs: update ci and ignore policy`

## 3. PR 规范

每个 PR 建议包含：

1. **改动目的**（为什么做）
2. **改动范围**（改了哪些目录/模块）
3. **验证方式**（本地执行命令、截图或日志）
4. **风险与回滚**（尤其是 workflow / 构建 / 变量结构改动）

推荐控制粒度：

- 单个 PR 关注一个主题（例如“只改 store 层”或“只改导出功能”）。

## 4. Code Review 关注点

Reviewer 重点检查：

- 业务正确性：是否满足计划与验收标准。
- 稳定性：超时、重试、异常路径是否闭环。
- 可维护性：模块边界是否清晰，避免巨型文件。
- 流程一致性：是否符合“test + build”双工作流策略。

## 5. 开发约定（针对本项目）

- 优先复用现有模板能力（Pinia、VueUse、脚本 API）。
- 脚本设置项需通过 zod 建模并持久化。
- UI 改动尽量以组件化方式提交，避免把逻辑塞进单文件。
- 任何“新规则”先写到 `docs/`，再口头同步。

## 6. Definition of Done（任务完成定义）

一个任务被认为完成，至少满足：

- [ ] 功能可用，且关键路径可手动验证
- [ ] 无明显 lint/build 错误
- [ ] 文档已更新（如有新行为/新配置）
- [ ] PR 描述完整，便于后续追溯

## 7. 历史重写协作约定

涉及“清理过往提交历史”的操作属于高风险变更，必须遵守：

1. 先在 PR/Issue 中公告窗口期。
2. 明确 freeze 时间，暂停其他分支合并。
3. 重写后统一通知成员重新同步本地仓库。
4. 保留一次性回滚方案（备份 tag 或镜像仓库）。
